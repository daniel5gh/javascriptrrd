<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8" />
	<TITLE>rrdFlotSupport module</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 3.0  (Linux)" />
	<META NAME="Info 1" CONTENT="" />
	<META NAME="Info 2" CONTENT="" />
	<META NAME="Info 3" CONTENT="" />
	<META NAME="Info 4" CONTENT="" />
	<STYLE TYPE="text/css">
	<!--
		@page { margin: 0.79in }
		TD P { margin-bottom: 0.08in }
		H1 { margin-bottom: 0.08in }
		H1.western { font-family: "Liberation Sans", sans-serif; font-size: 22pt }
		P { margin-bottom: 0.08in }
		h2.heading-2-western { font-family: "Liberation Serif", serif; font-size: 16pt }
		TH P { margin-bottom: 0.08in }
		A:link { so-language: zxx }
	-->
	</STYLE>
</HEAD>
<body LANG="en-US" DIR="LTR">
<h1 class="western">rrdFlotSupport module</h1>
<table width='50%' cellpadding='2' CELLSPACING='2'>
	<tr>
		<td>
			<hr />
			<p>The <a href="../../src/lib/rrdFlotSupport.js">rrdFlotSupport Javascript module</a> 
                        implements a set of commonly used functions an classes that may be used while plotting 
                        <a href="http://oss.oetiker.ch/rrdtool/">RRD files</a> with 
                        <a href="http://www.flotcharts.org/">Flot</a>.</p>
			<hr />
		</td>
	</tr>
</table>
<h2 class="heading-2-western">Overview</h2>
<p>This module provides two types of support:
<ul>
 <li>Functions providing support in converting raw data into Flot-friendly format:
    <a href="#rrdDS2FlotSeries">rrdDS2FlotSeries</a>,
    <a href="#rrdRRA2FlotObj">rrdRRA2FlotObj</a>,
     <a href="#rrdRRAStackFlotObj">rrdRRAStackFlotObj</a> and
     <a href="#rrdRRAMultiStackFlotObj">rrdRRAMultiStackFlotObj</a>.</li>
 <li>A class providing support for handling the plotting:
	 <a href="#rrdFlotSelection">rrdFlotSelection</a>.</li>
</ul>
</p>
<h2 class="heading-2-western"><a NAME="rrdDS2FlotSeries"></a>Function rrdDS2FlotSeries</h2>
<p>This function extracts a specific DS from a specific RRA and returns an object that 
contains the data in format flot expects.</p>
<p>
Input parameters:
</p>
<div align='right'>
	<table width='90%' border='1' cellpadding='2' cellspacing='3'>
		<col width='51*' />
		<col width='205*' />
		<THEAD>
			<tr valign='top'>
				<TH width='20%'>
					<p align='left'>Parameter</p>
				</TH>
				<TH width='80%'>
					<p align='left'>Description</p>
				</TH>
			</tr>
		</THEAD>
		<tbody>
			<tr valign='top'>
				<td width='20%'>
					<p>rrd_file</p>
				</td>
				<td width='80%'>
					<p>An object of type <a href="rrdFile_js.html#RRDFile">RRDFile</a> or equivalent.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>ds_id</p>
				</td>
				<td width='80%'>
					<p>Identifier of the desired DS (as accepted by
                                            <a href="rrdFile_js.html#RRDFile">RRDFile.getDS()</a>).</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>rra_idx</p>
				</td>
				<td width='80%'>
					<p>Index of the desired RRA.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>want_rounding</p>
				</td>
				<td width='80%'>
					<p>If not false, all timestamps will be truncated to the RRA step.</p>
				</td>
			</tr>
		</tbody>
	</table>
</div>
<p>
The output is an object containing:
</p>
<div align='right'>
	<table width='90%' border='1' cellpadding='2' cellspacing='3'>
		<col width='51*' />
		<col width='205*' />
		<THEAD>
			<tr valign='top'>
				<TH width='20%'>
					<p align='left'>Attribute</p>
				</TH>
				<TH width='80%'>
					<p align='left'>Description</p>
				</TH>
			</tr>
		</THEAD>
		<tbody>
			<tr valign='top'>
				<td width='20%'>
					<p>data</p>
				</td>
				<td width='80%'>
					<p>A list of datapoints suitable to be fed to <a href="http://www.flotcharts.org/">Flot</a>. Each element is a (Timestamp in ms, value) pair.</p>
                                        <p>An example of use with Flot:<br />
<pre>
var fd=rrdDS2FlotSeries(...);
var plot = $.plot("#myplot", [{data:fd.data}], options);
</pre>
                                        </p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>label</p>
				</td>
				<td width='80%'>
					<p>The DS name.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>min</p>
				</td>
				<td width='80%' ROWSPAN='2'>
					<p>Min and max timestamp in ms.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>max</p>
				</td>
                        </tr>
		</tbody>
	</table>
</div>
<h2 class="heading-2-western"><a NAME="rrdRRA2FlotObj"></a>Function rrdRRA2FlotObj</h2>
<p>This function extracts a list of DSs from a specific RRA and returns an object that 
contains the data in format flot expects.</p>
<p>
Input parameters:
</p>
<div align='right'>
	<table width='90%' border='1' cellpadding='2' cellspacing='3'>
		<col width='51*' />
		<col width='205*' />
		<THEAD>
			<tr valign='top'>
				<TH width='20%'>
					<p align='left'>Parameter</p>
				</TH>
				<TH width='80%'>
					<p align='left'>Description</p>
				</TH>
			</tr>
		</THEAD>
		<tbody>
			<tr valign='top'>
				<td width='20%'>
					<p>rrd_file</p>
				</td>
				<td width='80%'>
					<p>An object of type <a href="rrdFile_js.html#RRDFile">RRDFile</a> or equivalent.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>rra_idx</p>
				</td>
				<td width='80%'>
					<p>Index of the desired RRA.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>ds_list</p>
				</td>
				<td width='80%'>
					<p>List of DS identifiers (as accepted by
                                            <a href="rrdFile_js.html#RRDFile">RRDFile.getDS()</a>).</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>want_ds_labels</p>
				</td>
				<td width='80%'>
					<p>Should the DS names be included as labels in the output? 
                                           (If false, only the order distinguishes the requested DSs)</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>want_rounding</p>
				</td>
				<td width='80%'>
					<p>If not false, all timestamps will be truncated to the RRA step.</p>
				</td>
			</tr>
		</tbody>
	</table>
</div>
<p>
The output is an object containing:
</p>
<div align='right'>
	<table width='90%' border='1' cellpadding='2' cellspacing='3'>
		<col width='51*' />
		<col width='205*' />
		<THEAD>
			<tr valign='top'>
				<TH width='20%'>
					<p align='left'>Attribute</p>
				</TH>
				<TH width='80%'>
					<p align='left'>Description</p>
				</TH>
			</tr>
		</THEAD>
		<tbody>
			<tr valign='top'>
				<td width='20%'>
					<p>data</p>
				</td>
				<td width='80%'>
					<p>A list of objects suitable to be fed to <a href="http://www.flotcharts.org/">Flot</a>. Each element is an object composed of two attributes:<ul>
                                         <li>data - A list of (Timestamp in ms, value) pairs.</li>
                                         <li>label - The (optional) DS name.</li></ul></p>
                                        <p>An example of use with Flot:<br />
<pre>
var fd=rrdDS2FlotObj(...);
var plot = $.plot("#myplot", fd.data, options);
</pre>
                                        </p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>min</p>
				</td>
				<td width='80%' ROWSPAN='2'>
					<p>Min and max timestamp in ms.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>max</p>
				</td>
                        </tr>
		</tbody>
	</table>
</div>
<h2 class="heading-2-western"><a NAME="rrdRRAStackFlotObj"></a>Function rrdRRAStackFlotObj</h2>
<p>This function extracts a list of DSs from a specific RRA, stacks them as requested and
returns an object that contains the data in format flot expects.</p>
<p>
Input parameters:
</p>
<div align='right'>
	<table width='90%' border='1' cellpadding='2' cellspacing='3'>
		<col width='51*' />
		<col width='205*' />
		<THEAD>
			<tr valign='top'>
				<TH width='20%'>
					<p align='left'>Parameter</p>
				</TH>
				<TH width='80%'>
					<p align='left'>Description</p>
				</TH>
			</tr>
		</THEAD>
		<tbody>
			<tr valign='top'>
				<td width='20%'>
					<p>rrd_file</p>
				</td>
				<td width='80%'>
					<p>An object of type <a href="rrdFile_js.html#RRDFile">RRDFile</a> or equivalent.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>rra_idx</p>
				</td>
				<td width='80%'>
					<p>Index of the desired RRA.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>ds_positive_stack_list</p>
				</td>
				<td width='80%'>
					<p>List of DS identifiers (as accepted by
                                            <a href="rrdFile_js.html#RRDFile">RRDFile.getDS()</a>)
				           to be stacked. All values must be positive if
				           ds_negative_stack_list is not empty.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>ds_negative_stack_list</p>
				</td>
				<td width='80%'>
					<p>List of DS identifiers (as accepted by
                                            <a href="rrdFile_js.html#RRDFile">RRDFile.getDS()</a>)
				           to be stacked. All values must be negative if
				           ds_positive_stack_list is not empty.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>ds_single_list</p>
				</td>
				<td width='80%'>
					<p>List of DS identifiers (as accepted by
                                            <a href="rrdFile_js.html#RRDFile">RRDFile.getDS()</a>).
				           No stacking for these ones.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>want_ds_labels</p>
				</td>
				<td width='80%'>
					<p>Should the DS names be included as labels in the output? 
                                           (If false, only the order distinguishes the requested DSs)</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>want_rounding</p>
				</td>
				<td width='80%'>
					<p>If not false, all timestamps will be truncated to the RRA step.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>one_undefined_enough</p>
				</td>
				<td width='80%'>
					<p>If true, a whole stack is invalidated if a
				           single element of the stack is invalid.</p>
				</td>
			</tr>
		</tbody>
	</table>
</div>
<p>
The output is an object containing:
</p>
<div align='right'>
	<table width='90%' border='1' cellpadding='2' cellspacing='3'>
		<col width='51*' />
		<col width='205*' />
		<THEAD>
			<tr valign='top'>
				<TH width='20%'>
					<p align='left'>Attribute</p>
				</TH>
				<TH width='80%'>
					<p align='left'>Description</p>
				</TH>
			</tr>
		</THEAD>
		<tbody>
			<tr valign='top'>
				<td width='20%'>
					<p>data</p>
				</td>
				<td width='80%'>
					<p>A list of objects suitable to be fed to <a href="http://www.flotcharts.org/">Flot</a>. Each element is an object composed of two attributes:<ul>
                                         <li>data - A list of (Timestamp in ms, value) pairs.</li>
                                         <li>label - The (optional) DS name.</li></ul></p>
                                        <p>An example of use with Flot:<br />
<pre>
var fd=rrdDS2FlotObj(...);
var plot = $.plot("#myplot", fd.data, options);
</pre>
                                        </p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>min</p>
				</td>
				<td width='80%' ROWSPAN='2'>
					<p>Min and max timestamp in ms.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>max</p>
				</td>
                        </tr>
		</tbody>
	</table>
</div>
<h2 class="heading-2-western"><a NAME="rrdRRAMultiStackFlotObj"></a>Function rrdRRAMultiStackFlotObj</h2>
<p>This function extracts a DS from a list of RRDs, using a specific RRA index, then stacks them and
returns an object that contains the data in format flot expects.</p>
<p>
Input parameters:
</p>
<div align='right'>
	<table width='90%' border='1' cellpadding='2' cellspacing='3'>
		<col width='51*' />
		<col width='205*' />
		<THEAD>
			<tr valign='top'>
				<TH width='20%'>
					<p align='left'>Parameter</p>
				</TH>
				<TH width='80%'>
					<p align='left'>Description</p>
				</TH>
			</tr>
		</THEAD>
		<tbody>
			<tr valign='top'>
				<td width='20%'>
					<p>rrd_files</p>
				</td>
				<td width='80%'>
					<p>A list of RRDs. Each element of the list contains a [rrd_id,rrd_file] pair.
				           <ul>
						   <li>rrd_id - Logical name for the RRD.</li>
						   <li>rrd_file -An object of type <a href="rrdFile_js.html#RRDFile">RRDFile</a> or equivalent.</li>
					   </ul>
					</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>rra_idx</p>
				</td>
				<td width='80%'>
					<p>Index of the desired RRA.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>ds_id</p>
				</td>
				<td width='80%'>
					<p>DS indentifier  (as accepted by
                                            <a href="rrdFile_js.html#RRDFile">RRDFile.getDS()</a>)</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>want_rrd_labels</p>
				</td>
				<td width='80%'>
					<p>Should the RRD names be included as labels in the output? 
                                           (If false, only the order distinguishes the requested RRDs)</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>want_rounding</p>
				</td>
				<td width='80%'>
					<p>If not false, all timestamps will be truncated to the RRA step.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>one_undefined_enough</p>
				</td>
				<td width='80%'>
					<p>If true, a whole stack is invalidated if a
				           single element of the stack is invalid.</p>
				</td>
			</tr>
		</tbody>
	</table>
</div>
<p>
The output is an object containing:
</p>
<div align='right'>
	<table width='90%' border='1' cellpadding='2' cellspacing='3'>
		<col width='51*' />
		<col width='205*' />
		<THEAD>
			<tr valign='top'>
				<TH width='20%'>
					<p align='left'>Attribute</p>
				</TH>
				<TH width='80%'>
					<p align='left'>Description</p>
				</TH>
			</tr>
		</THEAD>
		<tbody>
			<tr valign='top'>
				<td width='20%'>
					<p>data</p>
				</td>
				<td width='80%'>
					<p>A list of objects suitable to be fed to <a href="http://www.flotcharts.org/">Flot</a>. Each element is an object composed of two attributes:<ul>
                                         <li>data - A list of (Timestamp in ms, value) pairs.</li>
                                         <li>label - The (optional) DS name.</li></ul></p>
                                        <p>An example of use with Flot:<br />
<pre>
var fd=rrdDS2FlotObj(...);
var plot = $.plot("#myplot", fd.data, options);
</pre>
                                        </p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>min</p>
				</td>
				<td width='80%' ROWSPAN='2'>
					<p>Min and max timestamp in ms.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>max</p>
				</td>
                        </tr>
		</tbody>
	</table>
</div>
<h2 class="heading-2-western"><a NAME="rrdFlotSelection"></a>Class rrdFlotSelection</h2>
<p>Helper class to handle <a href="http://www.flotcharts.org/">Flot</a> selections.
</p>
<div align='right'>
	<table width='90%' border='1' cellpadding='2' cellspacing='3'>
		<col width='52*' />
		<col width='204*' />
		<THEAD>
			<tr valign='top'>
				<TH width='20%'>
					<p align='left'>Method</p>
				</TH>
				<TH width='80%'>
					<p align='left'>Description</p>
				</TH>
			</tr>
		</THEAD>
		<tbody>
			<tr valign='top'>
				<td width='20%'>
					<p>reset()</p>
				</td>
				<td width='80%'>
					<p>Clear the selection. (isSet() will return False)</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>isSet()</p>
				</td>
				<td width='80%'>
					<p>Was a selection set?</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>setFromFlotRanges(ranges)</p>
				</td>
				<td width='80%'>
					<p>Set the selection to ranges.xaxis. See plotselected 
                                           <a href="http://www.flotcharts.org/">Flot</a>
                                           event for more info on ranges. (isSet() will return True, and getFlotRanges() can now be called.)</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>getFlotRanges()</p>
				</td>
				<td width='80%'>
					<p>Return a ranges object. See plotselected 
                                           <a href="http://www.flotcharts.org/">Flot</a>
                                           event for more info on ranges.</p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>trim_flot_data(flot_data)</p>
				</td>
				<td width='80%'>
					<p>Create a new Flot data object by selecting only the data points within the current selection.</p>
                                        <p>An example Flot data object is 
<pre>
rrdDS2FlotObj(...).data
</pre></p>
				</td>
			</tr>
			<tr valign='top'>
				<td width='20%'>
					<p>trim_data(data_list)</p>
				</td>
				<td width='80%'>
					<p>Create a new data list by selecting only the data points within the current selection.</p>
                                        <p>An example data list is 
<pre>
rrdDS2FlotSeries(...).data
</pre></p>
				</td>
			</tr>
		</tbody>
	</table>
</div>
<p>Pseudo-example of use:
<pre>
  myplotplot.bind("plotselected", function (event, ranges) {
      // do the zooming
      selection_range.setFromFlotRanges(ranges);
      graph_options.xaxis.min=ranges.xaxis.from;
      graph_options.xaxis.max=ranges.xaxis.to;
      mygraph = $.plot("#mygraph", selection_range.trim_flot_data(flot_data), graph_options);
  });
</pre>
</p>
<table width='50%' cellpadding='2' CELLSPACING='2'>
        <tr>
                <td>
                        <hr />
                        <p>This module is part of the <a href="index.html">javascriptRRD
                        package</a> hosted at <a href="http://javascriptrrd.sourceforge.net/">http://javascriptrrd.sourceforge.net</a>.
                        <br />It is licensed under the <a href="http://www.opensource.org/licenses/mit-license.php">MIT
                        license</a>.
                        </p>
                        <hr />
                </td>
        </tr>
</table>

</body>
</html>
